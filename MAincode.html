<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Launcher</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg: #1a0000;
            --header: #330000;
            --text: #fff;
            --muted: #ccc;
            --accent: #ff0000;
            --accentDark: #cc0000;
            --glowColor: #ff0000;
            --cardBg: #1a0000;
            --cardRadius: 15px;
            --glowSize: 20px;
            --glowStrength: 0.3;
            --fontFamily: 'Arial', sans-serif;
            --snowColor: #ffffff;
            --snowCount: 150;
            --snowSize: 3;
            --snowSpeed: 1.2;
            
            /* Tab Button Customization Variables */
            --tabSize: 60px;
            --tabBorderWidth: 3px;
            --tabBorderColor: #ff0000;
            --tabBgColor: transparent;
            --tabTextColor: #ffffff;
            --tabHoverScale: 1.1;
            --tabGlowIntensity: 20px;
            --tabIconSize: 24px;
        }

        body {
            font-family: var(--fontFamily);
            background: linear-gradient(135deg, var(--bg), #000000);
            color: var(--text);
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Custom Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0;
            z-index: -2;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        body.has-custom-background::before {
            opacity: 0.5;
        }

        /* Snow Canvas */
        #snowCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            mix-blend-mode: screen;
        }

        /* Sidebar - Now Horizontal Top Menu with Circular Buttons */
        .sidebar {
            width: 100%;
            height: auto;
            background: linear-gradient(180deg, var(--header), var(--bg));
            border-bottom: 3px solid var(--accent);
            padding: 15px 20px;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            gap: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
        }

        /* CIRCULAR OUTLINED TAB BUTTONS */
        .sidebar-item {
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .sidebar-item-circle {
            position: relative;
            background: var(--tabBgColor);
            border: var(--tabBorderWidth) solid var(--tabBorderColor);
            width: var(--tabSize);
            height: var(--tabSize);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--tabIconSize);
            color: var(--tabTextColor);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }

        .sidebar-item-text {
            font-size: 13px;
            font-weight: bold;
            color: var(--tabTextColor);
            text-align: center;
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        .sidebar-item:hover .sidebar-item-circle {
            transform: scale(var(--tabHoverScale)) translateY(-3px);
            box-shadow: 0 0 var(--tabGlowIntensity) var(--tabBorderColor);
            filter: brightness(1.2);
        }

        .sidebar-item:hover .sidebar-item-text {
            color: var(--glowColor);
            text-shadow: 0 0 10px var(--glowColor);
        }

        .sidebar-item.active .sidebar-item-circle {
            background: var(--tabBorderColor);
            border-color: #ffff00;
            box-shadow: 0 0 25px rgba(255, 255, 0, 0.6);
            animation: activeTabPulse 2s infinite;
        }

        .sidebar-item.active .sidebar-item-text {
            color: #ffff00;
            text-shadow: 0 0 10px rgba(255, 255, 0, 0.6);
        }

        @keyframes activeTabPulse {
            0%, 100% { box-shadow: 0 0 25px rgba(255, 255, 0, 0.6); }
            50% { box-shadow: 0 0 35px rgba(255, 255, 0, 0.9); }
        }

        /* Tooltip */
        .tooltip {
            position: absolute;
            left: 50%;
            top: 100%;
            transform: translateX(-50%);
            margin-top: 10px;
            background: var(--accent);
            color: var(--text);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 13px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.7);
            z-index: 200;
            border: 2px solid var(--glowColor);
        }

        .tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-bottom-color: var(--accent);
        }

        .sidebar-item:hover .tooltip {
            opacity: 1;
        }

        /* Main Content Area */
        .main-wrapper {
            margin-left: 0;
            margin-top: 100px;
            margin-bottom: 80px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: calc(100vh - 180px);
            padding: 20px;
        }

        /* Initial Loading Screen */
        #initial-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--bg), #000000);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .initial-spinner {
            position: relative;
            width: 120px;
            height: 120px;
            margin-bottom: 30px;
            perspective: 1000px;
        }

        .initial-spinner::before,
        .initial-spinner::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 8px solid transparent;
        }

        .initial-spinner::before {
            border-top-color: var(--accent);
            border-right-color: var(--accentDark);
            animation: spin3d 1.5s linear infinite;
            box-shadow: 0 0 30px var(--accent), inset 0 0 20px var(--glowColor);
        }

        .initial-spinner::after {
            border-bottom-color: var(--glowColor);
            border-left-color: var(--accentDark);
            animation: spin3d 2s linear infinite reverse;
            box-shadow: 0 0 20px var(--glowColor);
        }

        @keyframes spin3d {
            0% { transform: rotateY(0deg) rotateX(0deg); }
            100% { transform: rotateY(360deg) rotateX(360deg); }
        }

        .loader-text {
            font-size: 24px;
            font-weight: bold;
            color: var(--accent);
            text-shadow: 0 0 20px var(--glowColor);
            animation: textGlow 2s ease-in-out infinite;
        }

        .loader-progress {
            font-size: 18px;
            color: var(--muted);
            margin-top: 10px;
            text-align: center;
            min-height: 24px;
        }

        @keyframes textGlow {
            0%, 100% { opacity: 1; text-shadow: 0 0 20px var(--glowColor); }
            50% { opacity: 0.7; text-shadow: 0 0 30px var(--glowColor); }
        }

        /* Search Bar */
        .search-container {
            width: 100%;
            max-width: 800px;
            margin: 20px auto 40px;
            position: relative;
        }

        .search-bar {
            width: 100%;
            padding: 18px 60px 18px 25px;
            border: 3px solid var(--accent);
            border-radius: 50px;
            background: rgba(0, 0, 0, 0.6);
            color: var(--text);
            font-size: 16px;
            outline: none;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5), 0 0 15px var(--glowColor);
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .search-bar:focus {
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.7), 0 0 25px var(--glowColor);
            transform: translateY(-2px);
        }

        .search-bar::placeholder {
            color: var(--muted);
        }

        .search-icon {
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent);
            font-size: 20px;
            pointer-events: none;
        }

        /* Category Filter Buttons */
        .category-filter {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
            padding: 0 20px;
        }

        .category-btn {
            padding: 12px 30px;
            background: linear-gradient(145deg, var(--accentDark), var(--accent));
            border: 2px solid var(--accent);
            border-radius: 25px;
            color: var(--text);
            cursor: pointer;
            font-size: 15px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
        }

        .category-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px var(--glowColor);
            filter: brightness(1.2);
        }

        .category-btn.active {
            background: var(--accent);
            border-color: #ffff00;
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.5);
        }

        /* Games Grid */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
            width: 100%;
            max-width: 1400px;
            padding: 20px;
        }

        .game-card {
            background: linear-gradient(145deg, var(--cardBg), #220000);
            border: 3px solid var(--accent);
            border-radius: var(--cardRadius);
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
            position: relative;
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, var(--glowColor), transparent);
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .game-card:hover::before {
            opacity: var(--glowStrength);
        }

        .game-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.8), 0 0 var(--glowSize) var(--glowColor);
            border-color: var(--glowColor);
        }

        .game-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
            border-bottom: 3px solid var(--accent);
        }

        .game-info {
            padding: 20px;
        }

        .game-title {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--accent);
            text-shadow: 0 0 10px var(--glowColor);
        }

        .game-description {
            color: var(--muted);
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .game-category {
            display: inline-block;
            padding: 6px 14px;
            background: var(--accent);
            color: var(--text);
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-top: 10px;
            box-shadow: 0 0 10px var(--glowColor);
        }

        /* Fullscreen Iframe Overlay */
        .iframe-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            display: none;
            flex-direction: column;
        }

        .iframe-overlay.active {
            display: flex;
        }

        .iframe-header {
            background: linear-gradient(90deg, var(--header), var(--accentDark));
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid var(--accent);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.7);
        }

        .iframe-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--accent);
            text-shadow: 0 0 10px var(--glowColor);
        }

        .iframe-controls {
            display: flex;
            gap: 15px;
        }

        .iframe-btn {
            background: linear-gradient(145deg, var(--accentDark), var(--accent));
            border: 2px solid var(--accent);
            padding: 10px 20px;
            border-radius: 8px;
            color: var(--text);
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
        }

        .iframe-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px var(--glowColor);
            filter: brightness(1.2);
        }

        #gameIframe {
            width: 100%;
            height: calc(100% - 70px);
            border: none;
        }

        /* Settings Panel */
        .settings-content {
            max-width: 900px;
            width: 100%;
            background: linear-gradient(145deg, rgba(26, 0, 0, 0.95), rgba(51, 0, 0, 0.95));
            border: 3px solid var(--accent);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8), 0 0 30px var(--glowColor);
            backdrop-filter: blur(10px);
        }

        .settings-section {
            margin-bottom: 40px;
        }

        .settings-section h2 {
            color: var(--accent);
            font-size: 28px;
            margin-bottom: 20px;
            text-shadow: 0 0 15px var(--glowColor);
            border-bottom: 2px solid var(--accent);
            padding-bottom: 10px;
        }

        .settings-section h3 {
            color: var(--accent);
            font-size: 20px;
            margin-bottom: 15px;
            margin-top: 25px;
        }

        .setting-item {
            margin-bottom: 25px;
        }

        .setting-label {
            display: block;
            color: var(--text);
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .setting-input {
            width: 100%;
            padding: 12px 20px;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--accent);
            border-radius: 10px;
            color: var(--text);
            font-size: 15px;
            outline: none;
            transition: all 0.3s;
        }

        .setting-input:focus {
            border-color: var(--glowColor);
            box-shadow: 0 0 15px var(--glowColor);
        }

        .setting-range {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            outline: none;
            transition: all 0.3s;
        }

        .setting-range::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            background: var(--accent);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px var(--glowColor);
        }

        .setting-range::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: var(--accent);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px var(--glowColor);
        }

        .range-value {
            display: inline-block;
            margin-left: 15px;
            color: var(--accent);
            font-weight: bold;
            font-size: 16px;
        }

        .setting-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .setting-btn {
            background: linear-gradient(145deg, var(--accentDark), var(--accent));
            border: 2px solid var(--accent);
            padding: 14px 30px;
            border-radius: 10px;
            color: var(--text);
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
        }

        .setting-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px var(--glowColor);
            filter: brightness(1.2);
        }

        .setting-btn.secondary {
            background: linear-gradient(145deg, #555, #777);
            border-color: #888;
        }

        .setting-btn.secondary:hover {
            box-shadow: 0 6px 20px rgba(136, 136, 136, 0.5);
        }

        .color-picker-wrapper {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .color-picker {
            width: 60px;
            height: 40px;
            border: 2px solid var(--accent);
            border-radius: 8px;
            cursor: pointer;
            background: transparent;
        }

        /* Theme Preview */
        .theme-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .theme-option {
            padding: 20px;
            border: 3px solid var(--accent);
            border-radius: 12px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: linear-gradient(145deg, rgba(0,0,0,0.5), rgba(0,0,0,0.3));
        }

        .theme-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px var(--glowColor);
        }

        .theme-option.active {
            border-color: #ffff00;
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.5);
        }

        /* Favorites Panel */
        .favorites-content {
            max-width: 1200px;
            width: 100%;
        }

        .favorites-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            padding: 20px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--muted);
        }

        .empty-state h2 {
            font-size: 32px;
            margin-bottom: 15px;
            color: var(--accent);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.5);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 6px;
            box-shadow: 0 0 10px var(--glowColor);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--glowColor);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                flex-wrap: wrap;
                padding: 10px;
                gap: 15px;
            }

            .sidebar-item-circle {
                width: calc(var(--tabSize) * 0.8);
                height: calc(var(--tabSize) * 0.8);
                font-size: calc(var(--tabIconSize) * 0.8);
            }

            .sidebar-item-text {
                font-size: 11px;
            }

            .main-wrapper {
                margin-top: 140px;
            }

            .games-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 20px;
                padding: 10px;
            }

            .settings-content {
                padding: 20px;
            }
        }

        /* Hidden Content */
        .content-section {
            display: none;
            width: 100%;
            animation: fadeIn 0.5s ease;
        }

        .content-section.active {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
    </style>
</head>
<body>
    <!-- Snow Canvas -->
    <canvas id="snowCanvas"></canvas>

    <!-- Initial Loader -->
    <div id="initial-loader">
        <div class="initial-spinner"></div>
        <div class="loader-text">Loading Game Launcher...</div>
        <div class="loader-progress" id="loaderProgress">Initializing...</div>
    </div>

    <!-- Horizontal Top Menu (Sidebar) -->
    <div class="sidebar" style="display: none;">
        <div class="sidebar-item active" onclick="showSection('home')">
            <div class="sidebar-item-circle">
                üè†
            </div>
            <span class="sidebar-item-text">Home</span>
            <span class="tooltip">Browse all games</span>
        </div>
        <div class="sidebar-item" onclick="showSection('favorites')">
            <div class="sidebar-item-circle">
                ‚≠ê
            </div>
            <span class="sidebar-item-text">Favorites</span>
            <span class="tooltip">Your favorite games</span>
        </div>
        <div class="sidebar-item" onclick="showSection('settings')">
            <div class="sidebar-item-circle">
                ‚öôÔ∏è
            </div>
            <span class="sidebar-item-text">Settings</span>
            <span class="tooltip">Customize launcher</span>
        </div>
    </div>

    <!-- Main Content Wrapper -->
    <div class="main-wrapper" style="display: none;">
        <!-- Home Section -->
        <div class="content-section active" id="home">
            <div class="search-container">
                <input type="text" class="search-bar" id="searchBar" placeholder="üîç Search for games..." oninput="filterGames()">
                <div class="search-icon">üîç</div>
            </div>

            <div class="category-filter" id="categoryFilter">
                <button class="category-btn active" onclick="filterCategory('all', this)">All</button>
            </div>

            <div class="games-grid" id="gamesGrid">
                <!-- Games will be loaded here -->
                <div class="empty-state">
                    <h2>Loading games...</h2>
                    <p>Please wait while we load the game library.</p>
                </div>
            </div>
        </div>

        <!-- Favorites Section -->
        <div class="content-section" id="favorites">
            <div class="favorites-content">
                <h1 style="text-align: center; font-size: 36px; margin-bottom: 30px; color: var(--accent); text-shadow: 0 0 20px var(--glowColor);">
                    ‚≠ê Your Favorites
                </h1>
                <div class="favorites-grid" id="favoritesGrid">
                    <!-- Favorite games will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div class="content-section" id="settings">
            <div class="settings-content">
                <h1 style="text-align: center; font-size: 36px; margin-bottom: 30px; color: var(--accent); text-shadow: 0 0 20px var(--glowColor);">
                    ‚öôÔ∏è Settings
                </h1>

                <!-- Tab Button Customization -->
                <div class="settings-section">
                    <h2>üîò Tab Button Customization</h2>
                    <p style="color: var(--muted); margin-bottom: 20px;">Customize the appearance of the circular tab buttons at the top of the page.</p>
                    
                    <div class="setting-item">
                        <label class="setting-label">Button Size: <span class="range-value" id="tabSizeValue">60px</span></label>
                        <input type="range" class="setting-range" id="tabSizeRange" min="40" max="100" value="60" oninput="updateTabSize(this.value)">
                    </div>

                    <div class="setting-item">
                        <label class="setting-label">Border Width: <span class="range-value" id="tabBorderWidthValue">3px</span></label>
                        <input type="range" class="setting-range" id="tabBorderWidthRange" min="1" max="8" value="3" oninput="updateTabBorderWidth(this.value)">
                    </div>

                    <div class="setting-item">
                        <label class="setting-label">Border Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" class="color-picker" id="tabBorderColorPicker" value="#ff0000" oninput="updateTabBorderColor(this.value)">
                            <input type="text" class="setting-input" id="tabBorderColorInput" value="#ff0000" oninput="updateTabBorderColor(this.value)" style="width: 150px;">
                        </div>
                    </div>

                    <div class="setting-item">
                        <label class="setting-label">Background Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" class="color-picker" id="tabBgColorPicker" value="#000000" oninput="updateTabBgColor(this.value)">
                            <input type="text" class="setting-input" id="tabBgColorInput" value="transparent" oninput="updateTabBgColor(this.value)" style="width: 150px;">
                        </div>
                    </div>

                    <div class="setting-item">
                        <label class="setting-label">Text/Icon Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" class="color-picker" id="tabTextColorPicker" value="#ffffff" oninput="updateTabTextColor(this.value)">
                            <input type="text" class="setting-input" id="tabTextColorInput" value="#ffffff" oninput="updateTabTextColor(this.value)" style="width: 150px;">
                        </div>
                    </div>

                    <div class="setting-item">
                        <label class="setting-label">Hover Scale: <span class="range-value" id="tabHoverScaleValue">1.1</span></label>
                        <input type="range" class="setting-range" id="tabHoverScaleRange" min="1" max="1.5" step="0.05" value="1.1" oninput="updateTabHoverScale(this.value)">
                    </div>

                    <div class="setting-item">
                        <label class="setting-label">Glow Intensity: <span class="range-value" id="tabGlowValue">20px</span></label>
                        <input type="range" class="setting-range" id="tabGlowRange" min="0" max="50" value="20" oninput="updateTabGlow(this.value)">
                    </div>

                    <div class="setting-item">
                        <label class="setting-label">Icon Size: <span class="range-value" id="tabIconSizeValue">24px</span></label>
                        <input type="range" class="setting-range" id="tabIconSizeRange" min="16" max="40" value="24" oninput="updateTabIconSize(this.value)">
                    </div>

                    <div class="setting-buttons">
                        <button class="setting-btn secondary" onclick="resetTabButtonSettings()">Reset to Default</button>
                    </div>
                </div>

                <!-- Theme Customization -->
                <div class="settings-section">
                    <h2>üé® Theme Customization</h2>
                    <div class="theme-preview">
                        <div class="theme-option active" onclick="applyTheme('red', this)">
                            <h3 style="color: #ff0000;">Red (Default)</h3>
                        </div>
                        <div class="theme-option" onclick="applyTheme('blue', this)">
                            <h3 style="color: #0066ff;">Blue</h3>
                        </div>
                        <div class="theme-option" onclick="applyTheme('green', this)">
                            <h3 style="color: #00ff66;">Green</h3>
                        </div>
                        <div class="theme-option" onclick="applyTheme('purple', this)">
                            <h3 style="color: #9933ff;">Purple</h3>
                        </div>
                        <div class="theme-option" onclick="applyTheme('orange', this)">
                            <h3 style="color: #ff9900;">Orange</h3>
                        </div>
                        <div class="theme-option" onclick="applyTheme('cyan', this)">
                            <h3 style="color: #00ffff;">Cyan</h3>
                        </div>
                    </div>

                    <h3>Custom Colors</h3>
                    <div class="setting-item">
                        <label class="setting-label">Accent Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" class="color-picker" id="accentColorPicker" value="#ff0000" oninput="updateAccentColor(this.value)">
                            <input type="text" class="setting-input" id="accentColorInput" value="#ff0000" oninput="updateAccentColor(this.value)" style="width: 150px;">
                        </div>
                    </div>

                    <div class="setting-item">
                        <label class="setting-label">Background Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" class="color-picker" id="bgColorPicker" value="#1a0000" oninput="updateBgColor(this.value)">
                            <input type="text" class="setting-input" id="bgColorInput" value="#1a0000" oninput="updateBgColor(this.value)" style="width: 150px;">
                        </div>
                    </div>
                </div>

                <!-- Custom Background -->
                <div class="settings-section">
                    <h2>üñºÔ∏è Custom Background</h2>
                    <div class="setting-item">
                        <label class="setting-label">Background Image URL</label>
                        <input type="text" class="setting-input" id="bgImageInput" placeholder="Enter image URL...">
                    </div>
                    <div class="setting-buttons">
                        <button class="setting-btn" onclick="saveCustomBackground()">Apply Background</button>
                        <button class="setting-btn secondary" onclick="removeCustomBackground()">Remove Background</button>
                    </div>
                </div>

                <!-- Snow Effect -->
                <div class="settings-section">
                    <h2>‚ùÑÔ∏è Snow Effect</h2>
                    <div class="setting-item">
                        <label class="setting-label">Snow Particle Count: <span class="range-value" id="snowCountValue">150</span></label>
                        <input type="range" class="setting-range" id="snowCountRange" min="0" max="300" value="150" oninput="updateSnowCount(this.value)">
                    </div>
                    <div class="setting-item">
                        <label class="setting-label">Snow Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" class="color-picker" id="snowColorPicker" value="#ffffff" oninput="updateSnowColor(this.value)">
                            <input type="text" class="setting-input" id="snowColorInput" value="#ffffff" oninput="updateSnowColor(this.value)" style="width: 150px;">
                        </div>
                    </div>
                </div>

                <!-- Tab Customization -->
                <div class="settings-section">
                    <h2>üìë Browser Tab Customization</h2>
                    <div class="setting-item">
                        <label class="setting-label">Tab Title</label>
                        <input type="text" class="setting-input" id="tabTitleInput" placeholder="Enter custom tab title...">
                    </div>
                    <div class="setting-item">
                        <label class="setting-label">Tab Icon URL</label>
                        <input type="text" class="setting-input" id="tabIconInput" placeholder="Enter icon URL...">
                    </div>
                    <div class="setting-buttons">
                        <button class="setting-btn" onclick="saveTabCustomization()">Save Tab Settings</button>
                        <button class="setting-btn secondary" onclick="resetTabCustomization()">Reset Tab</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Fullscreen Iframe Overlay -->
    <div class="iframe-overlay" id="iframeOverlay">
        <div class="iframe-header">
            <div class="iframe-title" id="iframeTitle">Game Title</div>
            <div class="iframe-controls">
                <button class="iframe-btn" onclick="toggleFullscreen()">
                    ‚õ∂ Fullscreen
                </button>
                <button class="iframe-btn" onclick="closeGame()">
                    ‚úñÔ∏è Close
                </button>
            </div>
        </div>
        <iframe id="gameIframe" allowfullscreen></iframe>
    </div>

<script>
    // Sample Games Data
    let GAMES_DATA = [];
    
    // Fixed game source URLs
    const GITHUB_JSON_URL = 'https://raw.githubusercontent.com/ProjectApex1243/Unblockedweb/refs/heads/master/games.Json';
    const COVER_BASE_URL = 'https://cdn.jsdelivr.net/gh/ProjectApex1243/Unblockedweb@master/covers';
    const GAMES_BASE_URL = 'https://cdn.jsdelivr.net/gh/ProjectApex1243/Unblockedweb@master';

    // Loading state
    let isLoading = true;
    let gamesLoaded = false;

    async function loadGamesFromRepo() {
        console.log('Loading games from GitHub...');
        
        updateLoaderProgress('Connecting to game library...');
        
        try {
            console.log('Fetching from:', GITHUB_JSON_URL);
            
            updateLoaderProgress('Downloading game list...');
            const response = await fetch(GITHUB_JSON_URL);
            
            if (!response.ok) {
                throw new Error(`Failed to fetch: ${response.status} ${response.statusText}`);
            }
            
            updateLoaderProgress('Processing game data...');
            const text = await response.text();
            console.log('Raw response received (first 500 chars):', text.substring(0, 500));
            
            // FIX: The JSON file has template literals and trailing commas
            // We need to convert it to valid JSON
            let cleanText = text;
            
            // Remove all template literal syntax
            cleanText = cleanText.replace(/\$\{COVER_URL\}/g, COVER_BASE_URL);
            
            // Remove trailing commas before closing braces/brackets
            cleanText = cleanText.replace(/,\s*}/g, '}');
            cleanText = cleanText.replace(/,\s*]/g, ']');
            
            // Fix the first object which has a comma issue
            cleanText = cleanText.replace(/^\{/, '[').replace(/\}$/, ']');
            
            // Ensure we have proper array format
            if (!cleanText.trim().startsWith('[')) {
                cleanText = '[' + cleanText + ']';
            }
            
            console.log('Cleaned text (first 500 chars):', cleanText.substring(0, 500));
            
            // Try to parse as JSON
            let gamesArray;
            try {
                gamesArray = JSON.parse(cleanText);
            } catch (parseError) {
                console.error('JSON parse error:', parseError.message);
                console.error('Error at position:', parseError.position);
                console.error('Problematic text:', cleanText.substring(parseError.position - 50, parseError.position + 50));
                
                // Try alternative parsing - the file might be a JSONL format (each line is a JSON object)
                updateLoaderProgress('Trying alternative parsing...');
                const lines = text.trim().split('\n').filter(line => line.trim());
                gamesArray = [];
                
                for (let line of lines) {
                    try {
                        // Clean each line
                        line = line.replace(/\$\{COVER_URL\}/g, COVER_BASE_URL);
                        line = line.replace(/,\s*}$/, '}');
                        
                        const game = JSON.parse(line);
                        gamesArray.push(game);
                    } catch (lineError) {
                        console.warn('Failed to parse line:', line.substring(0, 100), 'Error:', lineError.message);
                    }
                }
                
                if (gamesArray.length === 0) {
                    throw new Error('Could not parse any valid JSON from the file');
                }
            }
            
            if (!Array.isArray(gamesArray)) {
                throw new Error('Games data is not an array');
            }
            
            console.log(`Parsed ${gamesArray.length} games`);
            updateLoaderProgress(`Processing ${gamesArray.length} games...`);
            
            // Transform to our format
            GAMES_DATA = gamesArray
                .filter(game => game && game.id != null && game.name)
                .map(game => {
                    let category = 'Games';
                    const name = (game.name || '').toLowerCase();
                    
                    // Simple categorization
                    if (name.includes('vex')) category = 'Vex Series';
                    else if (name.includes('fnf') || name.includes('friday night')) category = 'FNF Mods';
                    else if (name.includes('subway')) category = 'Subway Surfers';
                    else if (name.includes('geometry dash')) category = 'Geometry Dash';
                    else if (name.includes('mario')) category = 'Mario Games';
                    else if (name.includes('sonic')) category = 'Sonic Games';
                    else if (name.includes('pokemon')) category = 'Pokemon Games';
                    else if (name.includes('retro bowl')) category = 'Sports';
                    else if (name.includes('basketball') || name.includes('soccer') || name.includes('football')) category = 'Sports';
                    else if (name.includes('action')) category = 'Action';
                    else if (name.includes('puzzle')) category = 'Puzzle';
                    else if (name.includes('adventure')) category = 'Adventure';
                    else if (game.category) category = game.category;
                    
                    // Build game URL
                    let gameUrl = game.url || '#';
                    if (gameUrl && !gameUrl.startsWith('http') && !gameUrl.startsWith('#') && !gameUrl.startsWith('javascript')) {
                        gameUrl = `${GAMES_BASE_URL}/${gameUrl}`;
                    }
                    
                    // Handle image URL - already cleaned the ${COVER_URL} placeholder
                    let imageUrl = game.cover || game.image || game.thumbnail || '';
                    if (imageUrl && !imageUrl.startsWith('http') && !imageUrl.startsWith('data:')) {
                        // If it's a relative path, prepend the base URL
                        if (imageUrl.startsWith('/')) {
                            imageUrl = COVER_BASE_URL + imageUrl;
                        } else {
                            imageUrl = `${COVER_BASE_URL}/${imageUrl}`;
                        }
                    }
                    
                    // Fallback image
                    if (!imageUrl || imageUrl === '') {
                        imageUrl = 'https://via.placeholder.com/300x200/ff0000/ffffff?text=' + encodeURIComponent(game.name.substring(0, 20));
                    }
                    
                    return {
                        id: String(game.id || Math.random().toString(36).substr(2, 9)),
                        title: game.name,
                        category: category,
                        image: imageUrl,
                        url: gameUrl,
                        description: game.author ? `By ${game.author}` : (game.description || 'Play now!'),
                        author: game.author || 'Unknown',
                        featured: game.featured || false
                    };
                });
            
            console.log(`‚úÖ Successfully loaded ${GAMES_DATA.length} games`);
            updateLoaderProgress(`Loaded ${GAMES_DATA.length} games successfully!`);
            
            gamesLoaded = true;
            hideLoader();
            
        } catch (error) {
            console.error('Error loading games:', error);
            updateLoaderProgress(`Error: ${error.message}`);
            
            // Show error in games grid
            GAMES_DATA = [
                {
                    id: 'error1',
                    title: '‚ùå Failed to Load Games',
                    category: 'Error',
                    image: 'https://via.placeholder.com/300x200/ff0000/ffffff?text=Error',
                    url: '#',
                    description: `Failed to load games. Error: ${error.message}`,
                    author: 'System'
                }
            ];
            
            // Still hide loader after showing error
            setTimeout(hideLoader, 2000);
        }
    }

    function updateLoaderProgress(message) {
        const progressElement = document.getElementById('loaderProgress');
        if (progressElement) {
            progressElement.textContent = message;
        }
    }

    function hideLoader() {
        const loader = document.getElementById('initial-loader');
        const sidebar = document.querySelector('.sidebar');
        const mainWrapper = document.querySelector('.main-wrapper');
        
        if (loader) {
            loader.style.opacity = '0';
            loader.style.transition = 'opacity 0.5s ease';
            
            setTimeout(() => {
                loader.style.display = 'none';
                
                if (sidebar) {
                    sidebar.style.display = 'flex';
                    sidebar.style.animation = 'fadeIn 0.5s ease';
                }
                
                if (mainWrapper) {
                    mainWrapper.style.display = 'flex';
                    mainWrapper.style.animation = 'fadeIn 0.5s ease';
                }
                
                renderGames();
                generateCategories();
                
                // Initialize snow effect after loader is hidden
                initSnowEffect();
                
            }, 500); // Wait for fade out
        } else {
            // Fallback if loader doesn't exist
            if (sidebar) sidebar.style.display = 'flex';
            if (mainWrapper) mainWrapper.style.display = 'flex';
            renderGames();
            generateCategories();
        }
        
        isLoading = false;
    }

    let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
    let currentFilter = 'all';
    let currentSearchQuery = '';

    // Initialize Launcher
    async function initializeLauncher() {
        console.log('Initializing Game Launcher...');
        
        updateLoaderProgress('Loading launcher...');
        
        // Load all settings first
        await Promise.all([
            loadTabCustomization(),
            loadCustomBackground(),
            loadTheme(),
            loadTabButtonSettings()
        ]);
        
        updateLoaderProgress('Settings loaded, fetching games...');
        
        // Load games - this will hide the loader when done
        await loadGamesFromRepo();
    }

    // Tab Button Customization Functions
    function loadTabButtonSettings() {
        const settings = JSON.parse(localStorage.getItem('tabButtonSettings') || '{}');
        
        if (settings.size) {
            document.getElementById('tabSizeRange').value = settings.size;
            updateTabSize(settings.size);
        }
        if (settings.borderWidth) {
            document.getElementById('tabBorderWidthRange').value = settings.borderWidth;
            updateTabBorderWidth(settings.borderWidth);
        }
        if (settings.borderColor) {
            document.getElementById('tabBorderColorPicker').value = settings.borderColor;
            document.getElementById('tabBorderColorInput').value = settings.borderColor;
            updateTabBorderColor(settings.borderColor);
        }
        if (settings.bgColor) {
            document.getElementById('tabBgColorInput').value = settings.bgColor;
            if (settings.bgColor !== 'transparent') {
                document.getElementById('tabBgColorPicker').value = settings.bgColor;
            }
            updateTabBgColor(settings.bgColor);
        }
        if (settings.textColor) {
            document.getElementById('tabTextColorPicker').value = settings.textColor;
            document.getElementById('tabTextColorInput').value = settings.textColor;
            updateTabTextColor(settings.textColor);
        }
        if (settings.hoverScale) {
            document.getElementById('tabHoverScaleRange').value = settings.hoverScale;
            updateTabHoverScale(settings.hoverScale);
        }
        if (settings.glowIntensity) {
            document.getElementById('tabGlowRange').value = settings.glowIntensity;
            updateTabGlow(settings.glowIntensity);
        }
        if (settings.iconSize) {
            document.getElementById('tabIconSizeRange').value = settings.iconSize;
            updateTabIconSize(settings.iconSize);
        }
    }

    function saveTabButtonSettings(key, value) {
        const settings = JSON.parse(localStorage.getItem('tabButtonSettings') || '{}');
        settings[key] = value;
        localStorage.setItem('tabButtonSettings', JSON.stringify(settings));
    }

    function updateTabSize(value) {
        document.documentElement.style.setProperty('--tabSize', value + 'px');
        document.getElementById('tabSizeValue').textContent = value + 'px';
        saveTabButtonSettings('size', parseInt(value));
    }

    function updateTabBorderWidth(value) {
        document.documentElement.style.setProperty('--tabBorderWidth', value + 'px');
        document.getElementById('tabBorderWidthValue').textContent = value + 'px';
        saveTabButtonSettings('borderWidth', parseInt(value));
    }

    function updateTabBorderColor(value) {
        document.documentElement.style.setProperty('--tabBorderColor', value);
        document.getElementById('tabBorderColorPicker').value = value;
        document.getElementById('tabBorderColorInput').value = value;
        saveTabButtonSettings('borderColor', value);
    }

    function updateTabBgColor(value) {
        document.documentElement.style.setProperty('--tabBgColor', value);
        document.getElementById('tabBgColorInput').value = value;
        if (value !== 'transparent') {
            document.getElementById('tabBgColorPicker').value = value;
        }
        saveTabButtonSettings('bgColor', value);
    }

    function updateTabTextColor(value) {
        document.documentElement.style.setProperty('--tabTextColor', value);
        document.getElementById('tabTextColorPicker').value = value;
        document.getElementById('tabTextColorInput').value = value;
        saveTabButtonSettings('textColor', value);
    }

    function updateTabHoverScale(value) {
        document.documentElement.style.setProperty('--tabHoverScale', value);
        document.getElementById('tabHoverScaleValue').textContent = value;
        saveTabButtonSettings('hoverScale', parseFloat(value));
    }

    function updateTabGlow(value) {
        document.documentElement.style.setProperty('--tabGlowIntensity', value + 'px');
        document.getElementById('tabGlowValue').textContent = value + 'px';
        saveTabButtonSettings('glowIntensity', parseInt(value));
    }

    function updateTabIconSize(value) {
        document.documentElement.style.setProperty('--tabIconSize', value + 'px');
        document.getElementById('tabIconSizeValue').textContent = value + 'px';
        saveTabButtonSettings('iconSize', parseInt(value));
    }

    function resetTabButtonSettings() {
        localStorage.removeItem('tabButtonSettings');
        
        // Reset to defaults
        updateTabSize(60);
        updateTabBorderWidth(3);
        updateTabBorderColor('#ff0000');
        updateTabBgColor('transparent');
        updateTabTextColor('#ffffff');
        updateTabHoverScale(1.1);
        updateTabGlow(20);
        updateTabIconSize(24);
        
        // Reset inputs
        document.getElementById('tabSizeRange').value = 60;
        document.getElementById('tabBorderWidthRange').value = 3;
        document.getElementById('tabBorderColorPicker').value = '#ff0000';
        document.getElementById('tabBorderColorInput').value = '#ff0000';
        document.getElementById('tabBgColorInput').value = 'transparent';
        document.getElementById('tabTextColorPicker').value = '#ffffff';
        document.getElementById('tabTextColorInput').value = '#ffffff';
        document.getElementById('tabHoverScaleRange').value = 1.1;
        document.getElementById('tabGlowRange').value = 20;
        document.getElementById('tabIconSizeRange').value = 24;
        
        alert('Tab button settings have been reset to default values!');
    }

    // Section Navigation
    function showSection(sectionId) {
        // Hide all sections
        document.querySelectorAll('.content-section').forEach(section => {
            section.classList.remove('active');
        });
        
        // Show selected section
        const targetSection = document.getElementById(sectionId);
        if (targetSection) {
            targetSection.classList.add('active');
        }
        
        // Update sidebar active state
        document.querySelectorAll('.sidebar-item').forEach(item => {
            item.classList.remove('active');
        });
        
        // Find and activate the clicked sidebar item
        if (window.event) {
            const clickedElement = window.event.target.closest('.sidebar-item');
            if (clickedElement) {
                clickedElement.classList.add('active');
            }
        }
        
        // Load favorites if switching to favorites
        if (sectionId === 'favorites') {
            renderFavorites();
        }
    }

    // Games Rendering
    function generateCategories() {
        const categoriesSet = new Set(['all']);
        GAMES_DATA.forEach(game => {
            if (game && game.category) {
                categoriesSet.add(game.category);
            }
        });
        const categories = Array.from(categoriesSet);
        
        const filterContainer = document.getElementById('categoryFilter');
        
        if (!filterContainer) return;
        
        filterContainer.innerHTML = categories.map(cat => 
            `<button class="category-btn ${cat === currentFilter ? 'active' : ''}" onclick="filterCategory('${cat}', this)">${cat === 'all' ? 'All' : cat}</button>`
        ).join('');
    }

    function renderGames() {
        const gamesGrid = document.getElementById('gamesGrid');
        if (!gamesGrid) return;
        
        // Show loading message if still loading
        if (isLoading || !gamesLoaded) {
            gamesGrid.innerHTML = `
                <div class="empty-state" style="grid-column: 1 / -1;">
                    <h2>‚è≥ Loading Games...</h2>
                    <p>Please wait while we load the game library.</p>
                </div>
            `;
            return;
        }
        
        const filteredGames = GAMES_DATA.filter(game => {
            if (!game || !game.title) return false;
            const matchesCategory = currentFilter === 'all' || game.category === currentFilter;
            const matchesSearch = game.title.toLowerCase().includes(currentSearchQuery.toLowerCase()) || 
                                  (game.description && game.description.toLowerCase().includes(currentSearchQuery.toLowerCase()));
            return matchesCategory && matchesSearch;
        });

        if (filteredGames.length === 0) {
            gamesGrid.innerHTML = `
                <div class="empty-state" style="grid-column: 1 / -1;">
                    <h2>üòï No Games Found</h2>
                    <p>Try adjusting your search or filter.</p>
                </div>
            `;
            return;
        }

        gamesGrid.innerHTML = filteredGames.map(game => {
            const isFavorite = favorites.includes(game.id);
            return `
                <div class="game-card" onclick="openGame('${game.id}')">
                    <img src="${game.image}" alt="${game.title}" class="game-image" onerror="this.src='https://via.placeholder.com/300x200/ff0000/ffffff?text=No+Image'">
                    <div class="game-info">
                        <h3 class="game-title">${game.title}</h3>
                        <p class="game-description">${game.description}</p>
                        <span class="game-category">${game.category}</span>
                        <button class="iframe-btn" onclick="event.stopPropagation(); toggleFavorite('${game.id}')" style="margin-top: 15px; width: 100%;">
                            ${isFavorite ? '‚≠ê Remove from Favorites' : '‚òÜ Add to Favorites'}
                        </button>
                    </div>
                </div>
            `;
        }).join('');
    }

    function filterCategory(category, clickedElement) {
        currentFilter = category;
        renderGames();
        
        // Update active button
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        if (clickedElement) {
            clickedElement.classList.add('active');
        }
    }

    function filterGames() {
        const searchBar = document.getElementById('searchBar');
        if (searchBar) {
            currentSearchQuery = searchBar.value;
        }
        renderGames();
    }

    // Favorites
    function toggleFavorite(gameId) {
        const index = favorites.indexOf(gameId);
        if (index > -1) {
            favorites.splice(index, 1);
        } else {
            favorites.push(gameId);
        }
        localStorage.setItem('favorites', JSON.stringify(favorites));
        renderGames();
        if (document.getElementById('favorites').classList.contains('active')) {
            renderFavorites();
        }
    }

    function renderFavorites() {
        const favoritesGrid = document.getElementById('favoritesGrid');
        const favoriteGames = GAMES_DATA.filter(game => favorites.includes(game.id));

        if (favoriteGames.length === 0) {
            favoritesGrid.innerHTML = `
                <div class="empty-state" style="grid-column: 1 / -1;">
                    <h2>‚≠ê No Favorites Yet</h2>
                    <p>Add games to your favorites from the home section!</p>
                </div>
            `;
            return;
        }

        favoritesGrid.innerHTML = favoriteGames.map(game => `
            <div class="game-card" onclick="openGame('${game.id}')">
                <img src="${game.image}" alt="${game.title}" class="game-image" onerror="this.src='https://via.placeholder.com/300x200/ff0000/ffffff?text=No+Image'">
                <div class="game-info">
                    <h3 class="game-title">${game.title}</h3>
                    <p class="game-description">${game.description}</p>
                    <span class="game-category">${game.category}</span>
                    <button class="iframe-btn" onclick="event.stopPropagation(); toggleFavorite('${game.id}')" style="margin-top: 15px; width: 100%;">
                        ‚≠ê Remove from Favorites
                    </button>
                </div>
            </div>
        `).join('');
    }

    // Game Player
    function openGame(gameId) {
        const game = GAMES_DATA.find(g => g.id === gameId);
        if (!game) {
            alert('Game not found!');
            return;
        }

        document.getElementById('iframeTitle').textContent = game.title;
        document.getElementById('gameIframe').src = game.url;
        document.getElementById('iframeOverlay').classList.add('active');
    }

    function closeGame() {
        document.getElementById('iframeOverlay').classList.remove('active');
        document.getElementById('gameIframe').src = '';
    }

    function toggleFullscreen() {
        const iframe = document.getElementById('gameIframe');
        if (!document.fullscreenElement) {
            iframe.requestFullscreen();
        } else {
            document.exitFullscreen();
        }
    }

    // Theme Functions
    function applyTheme(theme, clickedElement) {
        const themes = {
            red: { accent: '#ff0000', accentDark: '#cc0000', glow: '#ff0000' },
            blue: { accent: '#0066ff', accentDark: '#0044cc', glow: '#0066ff' },
            green: { accent: '#00ff66', accentDark: '#00cc44', glow: '#00ff66' },
            purple: { accent: '#9933ff', accentDark: '#7722cc', glow: '#9933ff' },
            orange: { accent: '#ff9900', accentDark: '#cc7700', glow: '#ff9900' },
            cyan: { accent: '#00ffff', accentDark: '#00cccc', glow: '#00ffff' }
        };

        if (themes[theme]) {
            document.documentElement.style.setProperty('--accent', themes[theme].accent);
            document.documentElement.style.setProperty('--accentDark', themes[theme].accentDark);
            document.documentElement.style.setProperty('--glowColor', themes[theme].glow);
            
            localStorage.setItem('selectedTheme', theme);
            
            // Update theme options
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('active');
            });
            if (clickedElement) {
                clickedElement.classList.add('active');
            }
        }
    }

    function loadTheme() {
        const theme = localStorage.getItem('selectedTheme') || 'red';
        const themeData = {
            red: { accent: '#ff0000', accentDark: '#cc0000', glow: '#ff0000' },
            blue: { accent: '#0066ff', accentDark: '#0044cc', glow: '#0066ff' },
            green: { accent: '#00ff66', accentDark: '#00cc44', glow: '#00ff66' },
            purple: { accent: '#9933ff', accentDark: '#7722cc', glow: '#9933ff' },
            orange: { accent: '#ff9900', accentDark: '#cc7700', glow: '#ff9900' },
            cyan: { accent: '#00ffff', accentDark: '#00cccc', glow: '#00ffff' }
        };

        if (themeData[theme]) {
            document.documentElement.style.setProperty('--accent', themeData[theme].accent);
            document.documentElement.style.setProperty('--accentDark', themeData[theme].accentDark);
            document.documentElement.style.setProperty('--glowColor', themeData[theme].glow);
            
            // Update active theme option
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('active');
                const h3 = option.querySelector('h3');
                if (h3 && h3.textContent.toLowerCase().includes(theme)) {
                    option.classList.add('active');
                }
            });
        }
    }

    function updateAccentColor(color) {
        document.documentElement.style.setProperty('--accent', color);
        document.getElementById('accentColorPicker').value = color;
        document.getElementById('accentColorInput').value = color;
        localStorage.setItem('customAccent', color);
    }

    function updateBgColor(color) {
        document.documentElement.style.setProperty('--bg', color);
        document.getElementById('bgColorPicker').value = color;
        document.getElementById('bgColorInput').value = color;
        localStorage.setItem('customBg', color);
    }

    // Custom Background
    function saveCustomBackground() {
        const input = document.getElementById('bgImageInput');
        if (!input) return;
        
        const url = input.value.trim();
        if (url) {
            // Validate URL
            try {
                new URL(url);
            } catch (e) {
                alert('Please enter a valid image URL');
                return;
            }
            
            const style = document.createElement('style');
            style.id = 'custom-bg-style';
            style.textContent = `
                body::before {
                    background-image: url('${url}') !important;
                }
            `;
            
            // Remove existing style
            const existingStyle = document.getElementById('custom-bg-style');
            if (existingStyle) {
                existingStyle.remove();
            }
            
            document.head.appendChild(style);
            document.body.classList.add('has-custom-background');
            
            localStorage.setItem('customBackground', url);
            
            alert('Custom background has been applied!');
        }
    }

    function removeCustomBackground() {
        document.body.classList.remove('has-custom-background');
        const existingStyle = document.getElementById('custom-bg-style');
        if (existingStyle) {
            existingStyle.remove();
        }
        const input = document.getElementById('bgImageInput');
        if (input) {
            input.value = '';
        }
        localStorage.removeItem('customBackground');
        
        alert('Custom background has been removed');
    }

    function loadCustomBackground() {
        const bg = localStorage.getItem('customBackground');
        if (bg) {
            const input = document.getElementById('bgImageInput');
            if (input) {
                input.value = bg;
            }
            // Apply background
            saveCustomBackground();
        }
    }

    // Snow Effect
    function updateSnowCount(value) {
        document.documentElement.style.setProperty('--snowCount', value);
        document.getElementById('snowCountValue').textContent = value;
        localStorage.setItem('snowCount', value);
        initSnowEffect();
    }

    function updateSnowColor(color) {
        document.documentElement.style.setProperty('--snowColor', color);
        document.getElementById('snowColorPicker').value = color;
        document.getElementById('snowColorInput').value = color;
        localStorage.setItem('snowColor', color);
        initSnowEffect();
    }

    // Tab Customization
    function saveTabCustomization() {
        const titleInput = document.getElementById('tabTitleInput');
        const iconInput = document.getElementById('tabIconInput');
        
        if (!titleInput || !iconInput) return;
        
        const title = titleInput.value.trim();
        const icon = iconInput.value.trim();
        
        if (title) {
            document.title = title;
            localStorage.setItem('tabTitle', title);
        }
        
        if (icon) {
            try {
                new URL(icon);
            } catch (e) {
                alert('Please enter a valid icon URL');
                return;
            }
            
            let link = document.querySelector("link[rel*='icon']");
            if (!link) {
                link = document.createElement('link');
                link.rel = 'icon';
                document.head.appendChild(link);
            }
            link.href = icon;
            localStorage.setItem('tabIcon', icon);
        }
        
        alert('Browser tab customization saved!');
    }

    function resetTabCustomization() {
        document.title = 'Game Launcher';
        const titleInput = document.getElementById('tabTitleInput');
        const iconInput = document.getElementById('tabIconInput');
        
        if (titleInput) titleInput.value = '';
        if (iconInput) iconInput.value = '';
        
        localStorage.removeItem('tabTitle');
        localStorage.removeItem('tabIcon');
        
        let link = document.querySelector("link[rel*='icon']");
        if (link) link.remove();
        
        alert('Browser tab has been reset to default');
    }

    function loadTabCustomization() {
        const title = localStorage.getItem('tabTitle');
        const icon = localStorage.getItem('tabIcon');
        
        if (title) {
            document.title = title;
            const titleInput = document.getElementById('tabTitleInput');
            if (titleInput) {
                titleInput.value = title;
            }
        }
        
        if (icon) {
            const iconInput = document.getElementById('tabIconInput');
            if (iconInput) {
                iconInput.value = icon;
            }
            let link = document.querySelector("link[rel*='icon']");
            if (!link) {
                link = document.createElement('link');
                link.rel = 'icon';
                document.head.appendChild(link);
            }
            link.href = icon;
        }
    }

    // Snow Effect
    function initSnowEffect() {
        const canvas = document.getElementById('snowCanvas');
        if (!canvas) return;
        
        const ctx = canvas.getContext('2d');
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        const snowCount = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--snowCount')) || 150;
        const snowflakes = [];
        
        for (let i = 0; i < snowCount; i++) {
            snowflakes.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                radius: Math.random() * 3 + 1,
                speed: Math.random() * 1 + 0.5,
                wind: Math.random() * 0.5 - 0.25
            });
        }
        
        function drawSnow() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--snowColor') || '#ffffff';
            
            snowflakes.forEach(flake => {
                ctx.beginPath();
                ctx.arc(flake.x, flake.y, flake.radius, 0, Math.PI * 2);
                ctx.fill();
                
                flake.y += flake.speed;
                flake.x += flake.wind;
                
                if (flake.y > canvas.height) {
                    flake.y = 0;
                    flake.x = Math.random() * canvas.width;
                }
                
                if (flake.x > canvas.width) {
                    flake.x = 0;
                } else if (flake.x < 0) {
                    flake.x = canvas.width;
                }
            });
            
            requestAnimationFrame(drawSnow);
        }
        
        drawSnow();
        
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    }

    // Start - Wait for DOM to be fully loaded
    document.addEventListener('DOMContentLoaded', function() {
        initializeLauncher();
    });
</script>
</body>
</html>
